% -----------------------------------------------------------------------------
% June 1, 2016
% This file contains a sample Bridges paper in LaTeX format.
% It has been prepared by Doug McKenna, using previous
% versions by Craig Kaplan, Reza Sarhangi, and others.
% It has been vetted using TeXShop 2.36 on Mac OS X (10.6).
% TeXShop is part of the TeX Live distribution, available
% at http://www.tug.org/texlive/
%
% -----------------------------------------------------------------------------

\documentclass[11pt]{article}
\usepackage{amsmath, amsthm, amssymb}    % May not all be necessary
\usepackage{bridges}                     % Custom bridges proceedings style
\usepackage{graphicx}                    % For including pictures
\usepackage{hyperref}                    % For formatting (clickable) URLs
\usepackage{subcaption}		     % Aaron added this one for certain figures
\usepackage{xcolor}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
}

% -----------------------------------------------------------------------------

\title{Seeing and Hearing the Eigenvectors of a Fluid}
\author{ Aaron Demby Jones, JoAnn Kuchera-Morin and Theodore Kim\\
Media Arts and Technology Program\\ University of California, Santa Barbara\\
{\tt aaron.demby.jones@mat.ucsb.edu, jkm@create.ucsb.edu, kim@mat.ucsb.edu}
}

% \date{[Draft as of \today]}	% For your own draft purposes
\date{}				% Suppress any date on submissions

% -----------------------------------------------------------------------------

\begin{document}

% -----------------------------------------------------------------------------
% Aaron's convenience commands
\newcommand{\UU}{\mathbf{U}}
\newcommand{\uu}{\mathbf{u}}
\newcommand{\vv}{\mathbf{v}}
\newcommand{\utilde}{\mathbf{q}}
\newcommand{\ff}{\mathbf{f}}
\newcommand{\qq}{\mathbf{q}}
\newcommand{\aaa}{\mathbf{a}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\subspace}{\mathbb{S}}
\newcommand{\boldA}{\mathbf{A}}
\newcommand{\VV}{\mathbf{V}}
% -----------------------------------------------------------------------------
% Ted's commands
\newcommand{\todo}[1]{$\spadesuit$ {\bf #1} $\spadesuit$}


\maketitle

% Prevent page number 1 from being printed on the first page.
\thispagestyle{empty}

\begin{abstract}
The intricate shapes and sounds that arise from the eigenvectors of vibrating Chladni plates are a well-known phenomenon. We explore a generalization of this phenomenon by computing the patterns formed by the empirical eigenvectors of a computational fluid dynamics simulation. The eigenvectors form abstract, turbulent patterns in space, especially in the presence of non-physical excitations. The eigenvalues form a spectrum that does not possess a unique sonic mapping, so we construct a sonification that allows us to listen to the trajectory of the fluid.
\end{abstract}

% Bridges papers are usually no more than 8 pages in length.  So
% there's really no need to have numbered sections, unless the
% author really needs to refer to sections within the paper's text.  So to suppress
% sequential section numbers, append an asterisk to the \section command, as in:

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Introduction}
Chladni plates beautifully reveal the vibration modes, also known as the eigenvectors, of a rigid plate (Fig.~\ref{fig:chladni-plate}). These eigenvectors can be computed analytically, as they correspond to very small deformations (i.e.~vibrations), and can be written in terms of the Bi-Laplacian operator $(\Delta^2)$ over a square domain \cite{gander2012euler}. These visual representations can be extended to more complex scenarios, where the eigenvectors and their corresponding eigenvalues are instead computed numerically. In this work, we compute the eigenvectors of a dynamic computational fluid dynamics simulation, which involves large deformations instead of small vibrations, and the Navier-Stokes equations in lieu of a Bi-Laplacian. We then visualize the turbulent motion of the eigenvectors in this spectral representation and construct a sonification of the resulting frequencies to produce a mapping between fluid trajectories and sound. The results are organic visual forms with a unique character and a variety of associated sounds that unfold over rich spectral envelopes.

\begin{figure}
		\centering
		\includegraphics[height=0.3\textwidth]{Figures/chladni_plate.jpg}
		\includegraphics[height=0.3\textwidth]{Figures/LIC.jpg}
%		\vspace*{-1em}
		\caption{{\em{\bf Left:} Chladni patterns realized through a physical experiment. Source: Wikimedia Commons.} {\em{\bf Right:} Analytic 2D eigenvector of the Navier-Stokes equations using the method of de Witt et al.} \cite{deWitt:2012}.}
		\label{fig:chladni-plate}
\end{figure}

\section*{Empirical Eigenvectors of a Fluid}

In this work, we would like to compute the eigenvectors that arise from the Navier-Stokes equations for fluid flow. There are several different strategies for computing these vectors. For example, de Witt et al. \cite{deWitt:2012} computed the analytic eigenfunctions of the fluid velocity field over a simple square domain, and used them to advect (i.e.~push) a particulate through space. These eigenfunctions are composed of separable products of sines and cosines, and the results visually correspond closely to classic Chladni patterns (Fig.~\ref{fig:chladni-plate}, right).

We are interested in generating less classical results, so we prefer the use of ``empirical'' eigenvectors~\cite{Ryckelynck2005}. This approach goes by many names, such as the Proper Orthogonal Decomposition, Karhunen-Love expansion, or Hotelling transform, but we prefer the eigenvector nomenclature because it clarifies the connection to Chladni patterns. As the name suggests, it involves computing the eigenvectors of an empirically obtained data set, which in this case is the results of a computational fluid dynamics (CFD) simulation.

The eigenvectors are constructed as follows. We have a velocity field defined on a regular three-dimensional grid of $N$ cells, which we consider abstractly as the real vector space $\R^{3N}$. The CFD simulation has been stepped over $T$ timesteps, so it provides $T$ velocity fields defined over this grid. We would like to discover the $r$ most relevant, linearly independent vectors of this data set, $\uu_1, \ldots, \uu_r \in \R^{3N}$. If we arrange the $T$ velocity fields of the CFD simulation into the columns of a matrix, we obtain $\boldA \in \R^{3N \times T}$. Taking the singular value decomposition (SVD) yields $\boldA = \UU \Sigma \VV^T$.

The columns of $\UU$ are linearly independent and sorted by how well they characterize the data in $\boldA$. Recalling the rough German translation of {\em eigen} as ``characteristic,'' these columns comprise our empirical eigenvectors. The $\Sigma$ matrix is a diagonal matrix of singular values that quantify the strength of each vector's characterization. In the special case of linear modal analysis, these values correspond directly to audio frequencies, but in the general case of arbitrary CFD simulations that we are considering, this correspondence is no longer direct. However, we will later take the occasional existence of this relationship as a launching point for our own sonification strategy. As we are only interested in the $r$ most important eigenvectors, we usually truncate $\UU$ to its first $r$ columns, yielding $\UU \in \R^{3N \times r}$.

The columns of $\UU$ span an $r$-dimensional subspace $\R^r$ inside of $\R^{3N}$, and $\UU$ itself defines a projection operator. For this reason, these techniques are sometimes called subspace techniques, and vectors that live in this space are called ``subspace'' coordinates, or ``subspace'' vectors. Given the $t$th velocity field from the original CFD simulation $\uu_t \in \R^{3N}$, we can compute a much smaller, subspace approximation of $\uu_t$ by computing $\UU^T \uu_t = \qq_t \in \R^r$. The fact that subspace coordinates can be constructed in this manner has attracted significant interest in the engineering community because it is then often possible to run simulations, even those using the full Navier-Stokes equations, very quickly within this coordinate system \cite{Kim2013}.

We are interested in this representation for two additional reasons. First, it is straightforward to interpret the entries in each $\qq_t$ as the amplitudes in a quasi-frequency spectrum. Therefore, they are a convenient starting point for constructing an auditory representation of fluid motion. Second, the projection can be reversed, or ``lifted.'' Given an arbitrary sound $\qq_*$ that was constructed in the quasi-frequency spectrum, we can unambiguously translate that sound into a fluid motion by ``lifting'' the vector back to the $\R^{3N}$ space. This is accomplished by computing $\UU \qq_* = \uu_*$, which yields a velocity field that can then be used to drive a fluid's motion.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Visualization}

One of the challenges of subspace methods is the construction of an interesting set of eigenvectors. For example, if a set of smooth, featureless laminar flows are input into the SVD, there is no reason to believe that interesting eigenvectors will be obtained. In order to ensure that a rich set of eigenvectors are produced, we ran six separate CFD simulations using a standard fluid simulator \cite{Stam99}, where a turbulent plume of smoke was aimed at each face of a rectangular simulation domain. All of the simulation data was then concatenated into a matrix $\boldA$, and the resulting decomposition was then truncated to $r = 150$. To reveal the shape of the modes, we then ran a series of simulations with each of the modes sequentially isolated. A ``delta'' subspace vector $\qq_d$ was generated at each timestep where the $d$th entry is set to 1 and the rest of the vector was set to zero. A sequence of these results can be seen in Figure \ref{fig:eigs}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ADJ: These are the more direct analogy to the Chladni figures.
\begin{figure*}
	\centering
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0000.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0001.png}	
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0002.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0003.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0004.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0005.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0006.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0007.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0008.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0009.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0010.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0011.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0012.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0013.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0014.png}
	\includegraphics[width=0.24\textwidth]{Figures/modes/plume0015.png}
	\caption{\em Empirical eigenvectors discovered by taking the combined SVD of six separate Navier-Stokes simulations.}
	\label{fig:eigs}
\end{figure*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Other excitation strategies are also possible, including ones that are more closely guided by the physics that generated the original input data. We can gradually activate each eigenvector in sequence and then push the resulting vector $\qq$ through existing subspace simulation algorithms which have automatically constructed approximate $\R^r$ versions of the Navier-Stokes equations \cite{Kim2013}. Less physical approaches are also possible by treating $\qq$ as a set of mixing weights. We can then construct arbitrary paths $\varphi \colon [0, 1] \rightarrow \R^r$, sampled at $T$ time steps $\varphi_1, \ldots, \varphi_T$, that determine the corresponding $T$ time steps of a full-coordinate velocity field. In this vein, we show the fluid simulation that results from a random walk over an $r$-dimensional sphere of constant radius in the supplemental video. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Sonification}

\begin{figure*}
	\begin{subfigure}[h]{0.5\textwidth}
		\includegraphics[width=\textwidth]{figures/singulars.eps}
		\caption{Singular values: $r$ = 150} 
		\label{fig:singulars}
	\end{subfigure}
	%
	\begin{subfigure}[h]{0.5\textwidth}
		\includegraphics[width=\textwidth]{figures/remap_freqs.eps}
		\caption{Remapped frequencies: $f$ = 64 Hz, $s$ = 1.75}
		\label{fig:freqs}
	\end{subfigure}
	\caption{\em Singular values and their remapped frequencies. Note the logarithmic scale on both y-axes. The red lines on both plots indicate the bounds of the human audible frequency range.}
\end{figure*}

We will devise a strategy for converting the motion of a fluid into a sound. As mentioned previously, one of the main advantages of the empirical eigenvectors approach is that it already yields a quasi-frequency spectrum. However, some additional choices need to be made before these vectors can be made audible. This sequence of subjective but judicious choices is known as sonification. More precisely, according to Hermann \cite{hermann2008}, sonification is the ``data-dependent, systematic generation of sound.''

We begin by interpreting the $r$ singular values $\sigma_1, \ldots, \sigma_r$ from the singular-value decomposition as characteristic frequencies. There are two immediate concerns about this raw data. First, we can see in Figure \ref{fig:singulars} that the values range over approximately $4$ orders of magnitude, which is approximately $13$ octaves, and decrease to numbers less than $1$. However, the human audible frequency range begins at $20$ Hz and spans approximately $10$ octaves, up to $20000$ Hz \cite{rosen2011signals}. Thus, we must somehow normalize the data to this audible range. Secondly, the singular value spectrum begins with a maximum value and then decreases, whereas an audio spectrum starts at fundamental frequency and then increases. Hence, we invert the singular values. One way to construct a practical mapping is to specify a fundamental frequency $f$ and octave scaling $s$. Writing our audible frequencies as $f_1, \ldots, f_r$, we can define our mapping from singular values to audible frequencies as follows:

\begin{equation} 
\begin{aligned}
f_i &= f \cdot \left(\frac{\sigma_{i}^{-1}}{\sigma_{\textnormal{max}}^{-1}}\right)^{\frac{1}{s}} \\
&= f \cdot \left(\frac{\sigma_{\textnormal{max}}}{\sigma_i}\right)^{\frac{1}{s}}, \ i = 1, \ldots, r.
\end{aligned}
\end{equation}

The effect of this remapping can be seen in Figure \ref{fig:freqs}, where we have used a fundamental frequency of $f = 64$ Hz and an octave scaling of $s = 1.75$. The spectrum now begins at the fundamental, $f = 64$ Hz, and ranges up to a maximum of approximately $15000$ Hz, which is an acoustically acceptable spread.

With an audible spectrum established, we now choose amplitudes for each individual frequency. These can be mapped from a corresponding subspace vector $\qq \in \R^r$, as each of its $r$ components, $q_1, \ldots, q_r$ can be thought of as an amplitude for the $r$ corresponding frequencies $f_1, \ldots, f_r$. Care must be taken here to ensure that sum of all the amplitudes does not exceed unity gain, as this would lead to clipping. More concretely, we constrain the $L_1$ norm of $\qq$, $\lvert\qq\rvert_1 = \sum_{i=1}^{r}\lvert q_i \rvert$, to be at most $1$. A typical subspace vector $\qq$ may also contain negative components. However, these can simply be thought of as encoding a positive amplitude and a reversal of phase. The phase reversal can be discarded, as its perceivable effect is typically undesirable clicking artifacts.

With these considerations in hand, we design a mapping from a subspace vector $\qq$ to an amplitude vector $\aaa$ of unit $L_1$ norm as follows:
\begin{equation}
\begin{aligned}
a_i &= \frac{\lvert q_i \rvert}{\lvert\qq\rvert_1}, \ i = 1, \ldots, r.
\end{aligned}
\end{equation}
Given a sequence $(\qq_t)$ of vectors that describe a sampled trajectory $\qq_1, \ldots, \qq_T$ through the subspace $\R^r$, we can normalize each $\aaa_t$ vector individually. Alternatively, we can determine which $\qq_t$ has the maximum $L_1$ norm, which we denote ${\qq}_\textnormal{max}$, and normalize based on $\lvert\qq_{\textnormal{max}}\rvert_1$. The effect of the former is a relatively uniform volume level, while the latter yields a more variable volume envelope. Each approach has its own musical merit, depending on the compositional situation.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Synthesis}

With our mappings carried out, we can now produce an audible sound. To illustrate the basic mapping between the visual forms of the eigenvectors and their corresponding remapped frequencies, we move sequentially through the eigenvectors and their corresponding frequencies in the first supplemental video \cite{sequential}.This mapping generates a musical scale, and compositional operations can be carried out at the note level. For example, by scrambling the order of the frequencies and adding some rhythmic variety, we can produce a short melody, as demonstrated in the second supplemental video \cite{melody}.

% ADJ: Here is the code to generate the footnote citations of the YouTube URLs instead:
% {\tt sequential}\footnote{\url{https://youtu.be/cB79S4NwCHc}}
% {\tt melody}\footnote{\url{https://youtu.be/N6fzJXbn2ts}} 

The previous example essentially capture freeze frames of each individual mode. However, a smoother, more sophisticated auditory mapping is needed if we want to capture the flow of the smoke through mixtures of the modes. As a point of departure, we use subtractive synthesis, which passes a spectrally rich input signal through various filters in order to alter its timbre. In our case, we construct a filter bank that attenuates the input signal everywhere except at the resonant frequencies that correspond to the active modes. A particular amplitude vector $\aaa$ with component $a_i$ then tells us the strength with which each corresponding frequency $f_i$ will resonate. The nature of the input sound also strongly influences the resulting timbre; noise creates a more atmospheric effect, while impulses can create driving rhythmic textures. To match the fluid feel of the smoke propagation, we use broadband noise for the primary sound examples in this paper.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Time Evolution}
Static sound, while interesting as a new timbre for a few seconds, eventually grows stale. Thus, we would like to capture the time evolution of the subspace trajectory as a dynamic sonic event. This can be achieved by cycling through the the sequence of amplitude vectors $\aaa_1, \ldots, \aaa_T$ corresponding to the subspace trajectory $\qq_1, \ldots, \qq_T$. Using subtractive synthesis, as described above, we can generate a corresponding sound signal that changes subtly at each time step $t$. As previously discussed, different trajectories through the subspace generate different sequences of amplitude vectors. Musically, the unfolding of these trajectories over time occurs on a micro-scale, but the overall effect is perceived smoothly, much as the individual frames of a video fuse together into a continuous motion.

Experimentally, we have explored several different categories of subspace trajectories. In the third supplemental video \cite{reduced}, we gradually activate each eigenvector in sequence and push the resulting subspace vector through the reduced-space Navier-Stokes equations. In the final supplemental video {\cite{sphere}, we put aside the equations of fluid flow and walk the subspace vector $\qq$ across the surface of a sphere in $\R^r$. 

% ADJ: Here is the code to generate the footnote citations of the YouTube URLs instead:
% {\tt reduced}\footnote{\url{https://youtu.be/_DXRQZYLcdE}}
% {\tt sphere}\footnote{\url{https://youtu.be/y6zraBpH5PA}}

\section*{Conclusion}

We have performed a preliminary exploration into the visual and sonic patterns that arise from a generalized form of the Chladni plate experiment. Instead of studying the eigenvectors of the Bi-Laplacian operator, we computed the empirical eigenvectors associated with fluid flow. The resulting forms are visually striking, and the corresponding spectrum can be sonified to produce a promising compositional palette. Suspending the underlying physics and performing an abstract subspace traversal produces intriguing results, which suggest many possible avenues for future work. Indeed, the interplay between the audio and the visual forms seems to form a language that we intend to explore and codify.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% If you are only going to use a BibTeX database, from which all your cites will be
% taken and formatted consistently, use the following.

\bibliographystyle{plain}
\fontsize{10}{12}
\bibliography{mybib}

\end{document}